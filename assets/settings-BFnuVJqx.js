import{C as T,i as U,c as u}from"./index-CoPmNLxf.js";const g={compact:{name:"compact",label:"compact",description:"compact",dimensions:{width:400,height:300},maxCards:1,defaultCards:["elo","recentStreak","sessionStats","winrate","kd","winStreak","performance","multiKill","mapPerformance","performanceTrend","entryFragging","mvpAssist","recentMatches","maps"]},medium:{name:"medium",label:"medium",description:"medium",dimensions:{width:600,height:800},maxCards:2,defaultCards:["elo","winrate","kd","recentStreak","winStreak","performance","sessionStats","multiKill","mapPerformance","performanceTrend","entryFragging","mvpAssist","recentMatches","maps"]},full:{name:"full",label:"full",description:"full",dimensions:{width:800,height:1e3},maxCards:4,defaultCards:["elo","winrate","kd","recentMatches","performance","recentStreak","winStreak","maps","sessionStats","multiKill","mapPerformance","performanceTrend","entryFragging","mvpAssist"]}},n={nickname:"",size:"medium",opacity:100,liveMatch:{enabled:!0,opacity:100,autoHide:!1,autoHideDelay:60,showDuration:15,hideDuration:45},cards:[{id:"1",type:"elo",enabled:!0,order:0,duration:10},{id:"2",type:"winrate",enabled:!0,order:1,duration:10},{id:"3",type:"kd",enabled:!0,order:2,duration:10},{id:"4",type:"recentStreak",enabled:!0,order:3,duration:10},{id:"7",type:"recentMatches",enabled:!1,order:4,duration:10},{id:"9",type:"winStreak",enabled:!1,order:5,duration:10},{id:"10",type:"performance",enabled:!1,order:6,duration:10},{id:"11",type:"maps",enabled:!1,order:7,duration:10},{id:"12",type:"multiKill",enabled:!1,order:8,duration:10},{id:"13",type:"mapPerformance",enabled:!1,order:9,duration:10},{id:"14",type:"performanceTrend",enabled:!1,order:10,duration:10},{id:"15",type:"entryFragging",enabled:!1,order:11,duration:10},{id:"16",type:"mvpAssist",enabled:!1,order:12,duration:10},{id:"17",type:"sessionStats",enabled:!1,order:13,duration:10}],rotation:{enabled:!0,interval:10,transition:"fade"},animations:{fadeIn:!0,slideIn:!0}},z=T("settings",()=>{const e=U({...n,cards:n.cards.map(t=>({...t})),rotation:{...n.rotation},animations:{...n.animations},liveMatch:{...n.liveMatch}}),y=u(()=>g[e.value.size]),v=u(()=>!e.value.cards||!Array.isArray(e.value.cards)?[]:e.value.cards.filter(t=>t.enabled).sort((t,a)=>t.order-a.order)),S=u(()=>{const t=window.location.origin+"/overlay",a=new URLSearchParams;e.value.nickname&&a.append("nickname",e.value.nickname),e.value.size!=="medium"&&a.append("size",e.value.size);const i=v.value.map(l=>l.type).join(",");i&&a.append("cards",i),e.value.rotation.enabled&&(a.append("rotation","true"),a.append("interval",e.value.rotation.interval.toString()),a.append("transition",e.value.rotation.transition));const o=Object.entries(e.value.animations).filter(([l,c])=>c).map(([l])=>l);return o.length>0&&a.append("animations",o.join(",")),e.value.opacity!==100&&a.append("opacity",e.value.opacity.toString()),`${t}?${a.toString()}`}),w=u(()=>{var i,o,l,c;const t=window.location.origin+"/live-match",a=new URLSearchParams;return e.value.nickname&&a.append("nickname",e.value.nickname),((i=e.value.liveMatch)==null?void 0:i.opacity)!==void 0&&e.value.liveMatch.opacity!==100&&a.append("opacity",e.value.liveMatch.opacity.toString()),((o=e.value.liveMatch)==null?void 0:o.showDuration)!==void 0&&e.value.liveMatch.showDuration!==15&&a.append("showDuration",e.value.liveMatch.showDuration.toString()),((l=e.value.liveMatch)==null?void 0:l.hideDuration)!==void 0&&e.value.liveMatch.hideDuration!==45&&a.append("hideDuration",e.value.liveMatch.hideDuration.toString()),(c=e.value.liveMatch)!=null&&c.autoHide&&(a.append("autoHide","true"),e.value.liveMatch.autoHideDelay!==void 0&&a.append("autoHideDelay",e.value.liveMatch.autoHideDelay.toString())),`${t}?${a.toString()}`});function M(){const t=new URLSearchParams(window.location.search),a=t.get("nickname");a&&(e.value.nickname=a);const i=t.get("size");i&&["compact","medium","full"].includes(i)&&(e.value.size=i);const o=t.get("cards");if(o){const r=o.split(",").filter(s=>!f.includes(s));r.length>0&&(e.value.cards=r.map((s,p)=>({id:`${p+1}`,type:s,enabled:!0,order:p,duration:10})))}if(t.get("rotation")==="true"){e.value.rotation.enabled=!0;const r=t.get("interval");r&&(e.value.rotation.interval=parseInt(r));const s=t.get("transition");s&&(e.value.rotation.transition=s)}const c=t.get("animations");if(c){const r=c.split(",");e.value.animations={fadeIn:r.includes("fadeIn"),slideIn:r.includes("slideIn")}}const h=t.get("opacity");if(h){const r=parseInt(h);r>=0&&r<=100&&(e.value.opacity=r,window.location.pathname==="/live-match"&&(e.value.liveMatch.opacity=r))}if(window.location.pathname==="/live-match"){e.value.liveMatch||(e.value.liveMatch={...n.liveMatch});const r=t.get("showDuration");if(r){const d=parseInt(r);d>=5&&(e.value.liveMatch.showDuration=d)}const s=t.get("hideDuration");if(s){const d=parseInt(s);d>=5&&(e.value.liveMatch.hideDuration=d)}if(t.get("autoHide")==="true"){e.value.liveMatch.autoHide=!0;const d=t.get("autoHideDelay");d&&(e.value.liveMatch.autoHideDelay=parseInt(d))}}}function b(t){e.value={...e.value,...t}}function D(){e.value={...n,cards:n.cards.map(t=>({...t})),rotation:{...n.rotation},animations:{...n.animations},liveMatch:{...n.liveMatch}}}function m(){localStorage.setItem("overlay-settings",JSON.stringify(e.value))}const f=["avgKills","avgDeaths","eloDiff"];function k(){const t=localStorage.getItem("overlay-settings");if(t)try{const a=JSON.parse(t);let i=Array.isArray(a.cards)&&a.cards.length>0?a.cards.filter(o=>!f.includes(o.type)):n.cards;i.length===0&&(i=n.cards),e.value={...n,...a,cards:i,rotation:a.rotation||n.rotation,animations:a.animations||n.animations,liveMatch:{...n.liveMatch,...a.liveMatch}},a.cards&&a.cards.length!==i.length&&(console.log(`Migrated settings: removed ${a.cards.length-i.length} deprecated card(s)`),m())}catch(a){console.error("Failed to parse saved settings:",a),e.value={...n}}else e.value={...n}}function C(t){const a=g[t];e.value.size=t,e.value.cards=a.defaultCards.map((i,o)=>({id:`${Date.now()}-${o}`,type:i,enabled:!0,order:o,duration:10}))}function I(t){e.value.cards=t.map((a,i)=>({...a,order:i}))}function H(t){const a={id:`${Date.now()}`,type:t,enabled:!0,order:e.value.cards.length,duration:10};e.value.cards.push(a)}function P(t){e.value.cards=e.value.cards.filter(a=>a.id!==t)}function A(t){const a=e.value.cards.find(i=>i.id===t);a&&(a.enabled=!a.enabled)}return{settings:e,currentPreset:y,activeCards:v,overlayUrl:S,liveMatchUrl:w,loadFromUrl:M,updateSettings:b,resetSettings:D,saveToStorage:m,loadFromStorage:k,applyPreset:C,reorderCards:I,addCard:H,removeCard:P,toggleCard:A}});export{g as S,z as u};
