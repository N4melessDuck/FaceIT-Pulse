import{C as A,i as $,c as p}from"./index-C0iXSf4M.js";const g={compact:{name:"compact",label:"compact",description:"compact",dimensions:{width:400,height:300},maxCards:1,defaultCards:["elo","recentStreak","sessionStats","winrate","kd","winStreak","performance","multiKill","mapPerformance","performanceTrend","entryFragging","mvpAssist","recentMatches","maps"]},medium:{name:"medium",label:"medium",description:"medium",dimensions:{width:600,height:800},maxCards:2,defaultCards:["elo","winrate","kd","recentStreak","winStreak","performance","sessionStats","multiKill","mapPerformance","performanceTrend","entryFragging","mvpAssist","recentMatches","maps"]},full:{name:"full",label:"full",description:"full",dimensions:{width:800,height:1e3},maxCards:4,defaultCards:["elo","winrate","kd","recentMatches","performance","recentStreak","winStreak","maps","sessionStats","multiKill","mapPerformance","performanceTrend","entryFragging","mvpAssist"]}},n={nickname:"",size:"medium",opacity:100,liveMatch:{enabled:!0,opacity:100,autoHide:!1,autoHideDelay:60,showDuration:15,hideDuration:45},cards:[{id:"1",type:"elo",enabled:!0,order:0,duration:10},{id:"2",type:"winrate",enabled:!0,order:1,duration:10},{id:"3",type:"kd",enabled:!0,order:2,duration:10},{id:"4",type:"recentStreak",enabled:!0,order:3,duration:10},{id:"7",type:"recentMatches",enabled:!1,order:4,duration:10},{id:"9",type:"winStreak",enabled:!1,order:5,duration:10},{id:"10",type:"performance",enabled:!1,order:6,duration:10},{id:"11",type:"maps",enabled:!1,order:7,duration:10},{id:"12",type:"multiKill",enabled:!1,order:8,duration:10},{id:"13",type:"mapPerformance",enabled:!1,order:9,duration:10},{id:"14",type:"performanceTrend",enabled:!1,order:10,duration:10},{id:"15",type:"entryFragging",enabled:!1,order:11,duration:10},{id:"16",type:"mvpAssist",enabled:!1,order:12,duration:10},{id:"17",type:"sessionStats",enabled:!1,order:13,duration:10}],rotation:{enabled:!0,interval:10,transition:"fade"},animations:{fadeIn:!0,slideIn:!0}},U=A("settings",()=>{const e=$({...n,cards:n.cards.map(a=>({...a})),rotation:{...n.rotation},animations:{...n.animations},liveMatch:{...n.liveMatch}}),y=p(()=>g[e.value.size]),m=p(()=>!e.value.cards||!Array.isArray(e.value.cards)?[]:e.value.cards.filter(a=>a.enabled).sort((a,t)=>a.order-t.order)),S=p(()=>{const a="/FaceIT-Pulse/".replace(/\/$/,""),t=window.location.origin+a+"/#/overlay",i=new URLSearchParams;e.value.nickname&&i.append("nickname",e.value.nickname),e.value.size!=="medium"&&i.append("size",e.value.size);const o=m.value.map(s=>s.type).join(",");o&&i.append("cards",o),e.value.rotation.enabled&&(i.append("rotation","true"),i.append("interval",e.value.rotation.interval.toString()),i.append("transition",e.value.rotation.transition));const u=Object.entries(e.value.animations).filter(([s,c])=>c).map(([s])=>s);return u.length>0&&i.append("animations",u.join(",")),e.value.opacity!==100&&i.append("opacity",e.value.opacity.toString()),`${t}?${i.toString()}`}),w=p(()=>{var o,u,s,c;const a="/FaceIT-Pulse/".replace(/\/$/,""),t=window.location.origin+a+"/#/live-match",i=new URLSearchParams;return e.value.nickname&&i.append("nickname",e.value.nickname),((o=e.value.liveMatch)==null?void 0:o.opacity)!==void 0&&e.value.liveMatch.opacity!==100&&i.append("opacity",e.value.liveMatch.opacity.toString()),((u=e.value.liveMatch)==null?void 0:u.showDuration)!==void 0&&e.value.liveMatch.showDuration!==15&&i.append("showDuration",e.value.liveMatch.showDuration.toString()),((s=e.value.liveMatch)==null?void 0:s.hideDuration)!==void 0&&e.value.liveMatch.hideDuration!==45&&i.append("hideDuration",e.value.liveMatch.hideDuration.toString()),(c=e.value.liveMatch)!=null&&c.autoHide&&(i.append("autoHide","true"),e.value.liveMatch.autoHideDelay!==void 0&&i.append("autoHideDelay",e.value.liveMatch.autoHideDelay.toString())),`${t}?${i.toString()}`});function M(){const a=new URLSearchParams(window.location.search),t=a.get("nickname");t&&(e.value.nickname=t);const i=a.get("size");i&&["compact","medium","full"].includes(i)&&(e.value.size=i);const o=a.get("cards");if(o){const r=o.split(",").filter(l=>!h.includes(l));r.length>0&&(e.value.cards=r.map((l,v)=>({id:`${v+1}`,type:l,enabled:!0,order:v,duration:10})))}if(a.get("rotation")==="true"){e.value.rotation.enabled=!0;const r=a.get("interval");r&&(e.value.rotation.interval=parseInt(r));const l=a.get("transition");l&&(e.value.rotation.transition=l)}const s=a.get("animations");if(s){const r=s.split(",");e.value.animations={fadeIn:r.includes("fadeIn"),slideIn:r.includes("slideIn")}}const c=a.get("opacity");if(c){const r=parseInt(c);r>=0&&r<=100&&(e.value.opacity=r,window.location.pathname==="/live-match"&&(e.value.liveMatch.opacity=r))}if(window.location.pathname==="/live-match"){e.value.liveMatch||(e.value.liveMatch={...n.liveMatch});const r=a.get("showDuration");if(r){const d=parseInt(r);d>=5&&(e.value.liveMatch.showDuration=d)}const l=a.get("hideDuration");if(l){const d=parseInt(l);d>=5&&(e.value.liveMatch.hideDuration=d)}if(a.get("autoHide")==="true"){e.value.liveMatch.autoHide=!0;const d=a.get("autoHideDelay");d&&(e.value.liveMatch.autoHideDelay=parseInt(d))}}}function b(a){e.value={...e.value,...a}}function D(){e.value={...n,cards:n.cards.map(a=>({...a})),rotation:{...n.rotation},animations:{...n.animations},liveMatch:{...n.liveMatch}}}function f(){localStorage.setItem("overlay-settings",JSON.stringify(e.value))}const h=["avgKills","avgDeaths","eloDiff"];function k(){const a=localStorage.getItem("overlay-settings");if(a)try{const t=JSON.parse(a);let i=Array.isArray(t.cards)&&t.cards.length>0?t.cards.filter(o=>!h.includes(o.type)):n.cards;i.length===0&&(i=n.cards),e.value={...n,...t,cards:i,rotation:t.rotation||n.rotation,animations:t.animations||n.animations,liveMatch:{...n.liveMatch,...t.liveMatch}},t.cards&&t.cards.length!==i.length&&(console.log(`Migrated settings: removed ${t.cards.length-i.length} deprecated card(s)`),f())}catch(t){console.error("Failed to parse saved settings:",t),e.value={...n}}else e.value={...n}}function C(a){const t=g[a];e.value.size=a,e.value.cards=t.defaultCards.map((i,o)=>({id:`${Date.now()}-${o}`,type:i,enabled:!0,order:o,duration:10}))}function I(a){e.value.cards=a.map((t,i)=>({...t,order:i}))}function P(a){const t={id:`${Date.now()}`,type:a,enabled:!0,order:e.value.cards.length,duration:10};e.value.cards.push(t)}function H(a){e.value.cards=e.value.cards.filter(t=>t.id!==a)}function T(a){const t=e.value.cards.find(i=>i.id===a);t&&(t.enabled=!t.enabled)}return{settings:e,currentPreset:y,activeCards:m,overlayUrl:S,liveMatchUrl:w,loadFromUrl:M,updateSettings:b,resetSettings:D,saveToStorage:f,loadFromStorage:k,applyPreset:C,reorderCards:I,addCard:P,removeCard:H,toggleCard:T}});export{g as S,U as u};
